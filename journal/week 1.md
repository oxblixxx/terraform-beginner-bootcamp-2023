# Terraform Beginner Bootcamp 2023 - Week 1


## STANDARD MODULE STRUCTURE (1.0.0)

### ROOT STRUCTURE

```
.
├── README.md
├── main.tf
├── provider.tf
├── variables.tf
├── variable.tfvars
├── outputs.tf
```


[Standard moudle structure](https://developer.hashicorp.com/terraform/language/modules/develop/structure)

### VARIABLE
Declaring an input variable could be done in various ways in terraform. Environment variables can be stored on your `terraform cloud` as well. Provider credentials needs to be stored on `terraform cloud`. Also `terraform variables` can me stored on the cloud as well, a variable.tf file must be created with the necessary arguments then the key and values are stored on the cloud.

### VARIABLE PRECEDENCE

Terraform environment variable precedence is the order in which Terraform looks for environment variables when loading variables. Terraform loads variables in the following order, with later sources taking precedence over earlier ones:

1. Environment variables 
2. The variable.tfvars file, if present The variable.tfvars.json file, if present
3. Any .auto.tfvars or .auto.tfvars.json files, processed in lexical order of their filenames
4. Any -var and -var-file options on the command line, in the order they are provided




### TERRAFORM.TFVARS
Terraform.tfvars is a file that contains the values for variables that are defined in the variable.tf file. It is a common way to store and manage the values for variables in your Terraform configuration.


### -VAR-FILE FLAG
The -var-file flag is used to pass the values for variables to Terraform from a file. This can be useful for storing sensitive values, such as database passwords and API keys, outside of your Terraform configuration. You can then use the -var-file flag to pass the file to Terraform when you apply your configuration.


### AUTO.TFVARS
You can use the auto.tfvars file to store sensitive values, such as database passwords and API keys, outside of your Terraform configuration. You can then use the -var-file flag to pass the auto.tfvars file to Terraform when you apply your configuration.



---

## CONFIGURATION DRIFT (1.1.0)

### RESOURCE DRIFT
Incase of a mistake of deleting a resource via the console, terraform informs the next time `terraform apply` is run that the resource doesn't exist anymore and will be creating a new one.

### TERRAFRM IMPORT
Import command is a special Terraform command that allows you to import existing infrastructure into Terraform.

*NB*: Ensure to check the resource documentation to check if the resource can be imported.

```
terraform import aws_instance.web i-12345678
```


### TERRAFORM IMPORT.TF
Import.tf is a special Terraform file that allows you to import existing infrastructure into Terraform. It is similar to the terraform import command, but it allows you to import multiple resources at once and to specify additional options, such as the Terraform resource type and the state file that you want to import the resources into.[^1] I imported an existing EC2 instance already created via console, the block of code is in `import.tf`


```
terraform plan -generate-config-out=generated.tf
```

Running that command shows the import changeset to fetch the resource details in the import block in generated.tf



### TERRAFORM GENERATED.TF

Generated.tf is a file that is generated by Terraform when you run the terraform import command or when you apply a Terraform configuration that contains an import block. The generated.tf file contains the Terraform configuration for the resources that were imported.



```
│ Error: Conflicting configuration arguments
│ 
│   with aws_instance.webserver,
│   on generated.tf line 20, in resource "aws_instance" "webserver":
│   20:   ipv6_addresses                       = []
│ 
│ "ipv6_addresses": conflicts with ipv6_address_count
╵
╷
│ Error: Conflicting configuration arguments
│ 
│   with aws_instance.webserver,
│   on generated.tf line 19, in resource "aws_instance" "webserver":
│   19:   ipv6_address_count                   = 0
│ 
│ "ipv6_address_count": conflicts with ipv6_addresses
```

### FIXING THE ERROR ABOVE
I simply opened the **generated.tf** file, I commented **ipv6_address_count**. The instruction to rectify the issue is to comment either **ipv6_addresses or ipv6_addresses_count** then you can run **terraform apply**


-[^1]:https://developer.hashicorp.com/terraform/language/import/generating-configuration